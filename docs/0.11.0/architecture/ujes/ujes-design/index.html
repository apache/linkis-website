<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-0.11.0 plugin-docs plugin-id-default docs-doc-id-architecture/ujes/ujes-design">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">UJES Design | Apache Linkis</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://linkis.apache.org/docs/0.11.0/architecture/ujes/ujes-design"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="0.11.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-0.11.0"><meta data-rh="true" name="docsearch:version" content="0.11.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-0.11.0"><meta data-rh="true" property="og:title" content="UJES Design | Apache Linkis"><meta data-rh="true" name="description" content="1 Document Overview"><meta data-rh="true" property="og:description" content="1 Document Overview"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://linkis.apache.org/docs/0.11.0/architecture/ujes/ujes-design"><link data-rh="true" rel="alternate" href="https://linkis.apache.org/docs/0.11.0/architecture/ujes/ujes-design" hreflang="en"><link data-rh="true" rel="alternate" href="https://linkis.apache.org/zh-CN/docs/0.11.0/architecture/ujes/ujes-design" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://linkis.apache.org/docs/0.11.0/architecture/ujes/ujes-design" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://AE29KQB3IA-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Linkis RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Linkis Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Apache Linkis JSON Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Apache Linkis" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.a810530b.css">
<link rel="preload" href="/assets/js/runtime~main.64b43126.js" as="script">
<link rel="preload" href="/assets/js/main.b45cbd22.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Apache Linkis Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Apache Linkis Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Apache Linkis</b></a><a class="navbar__item navbar__link" href="/download/main">Download</a><a class="navbar__item navbar__link" href="/community/how-to-subscribe">Community</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/team">Team</a><a class="navbar__item navbar__link" href="/user">Users</a><a href="https://docs.qq.com/doc/DUkdTTGhVSlZ0VXVt" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">FAQ</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">ASF</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Foundation</a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">License</a></li><li><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="dropdown__link">Events</a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Security</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsorship</a></li><li><a href="https://privacy.apache.org/policies/privacy-policy-public.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy</a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Thanks</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Doc</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/latest/about/introduction">1.3.2</a></li><li><a class="dropdown__link" href="/docs/1.3.1/about/introduction">1.3.1</a></li><li><a class="dropdown__link" href="/docs/1.3.0/introduction">1.3.0</a></li><li><a class="dropdown__link" href="/docs/1.2.0/introduction">1.2.0</a></li><li><a class="dropdown__link" href="/docs/1.1.1/introduction">1.1.1</a></li><li><a class="dropdown__link" href="/docs/1.4.0/about/introduction">Next(1.4.0)</a></li><li><a class="dropdown__link" href="/versions">All Version</a></li></ul></div><a href="https://github.com/apache/linkis" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/0.11.0/architecture/ujes/ujes-design" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/zh-CN/docs/0.11.0/architecture/ujes/ujes-design" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-CN">简体中文</a></li></ul></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/0.11.0/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/0.11.0/deployment/quick-deploy">Deployment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/0.11.0/user-guide/X-sdk-manual">User Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/0.11.0/engine-usage/hive">Engine Usage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/0.11.0/api/login-api">API Docs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/0.11.0/architecture/overview">Architecture</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.11.0/architecture/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.11.0/architecture/rm">RM design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.11.0/architecture/websocket">WebSocket Request</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/0.11.0/architecture/commons/real-time-log-push">Commons</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/0.11.0/architecture/storage/file-system">Storage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/0.11.0/architecture/ujes/ujes-design">UJES</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/0.11.0/architecture/ujes/ujes-design">UJES Design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.11.0/architecture/ujes/file-import-and-export-structure">Spark Engine File Import Export</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/0.11.0/architecture/ujes/asynchronous-thread-pool">Asynchronous Pool Call</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/0.11.0/development/compile-and-package">Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/0.11.0/upgrade/upgrade-from-0.9.0-to-0.9.1-guide">Upgrade Guide</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Apache Linkis<!-- --> <b>0.11.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/latest/about/introduction">latest version</a></b> (<!-- -->1.3.2<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Architecture</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">UJES</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">UJES Design</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 0.11.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>UJES Design</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-document-overview">1 Document Overview<a class="hash-link" href="#1-document-overview" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-project-background">1.1 Project background<a class="hash-link" href="#11-project-background" title="Direct link to heading">​</a></h3><p>UJES (Unified Job Execution Service), one of Linkis&#x27;s core components is the Integrated Job Enforcement Service.The project has provided a new generic framework programme for large data ecosystems in the way they are implemented in a microservice framework, which addresses some of the pain points in the use of existing open source projects of the same kind on the market.</p><p>This document is suitable for reading large data functional platforms, in particular the hadoop data ecosphere, with some work experience or interest in learning.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-interpretation-of-terms">1.2 Interpretation of terms<a class="hash-link" href="#12-interpretation-of-terms" title="Direct link to heading">​</a></h3><p>These terms are explained in this section by the terminology used later in the document for some items.</p><p>1) Gateway:</p><p> UJES&#x27;s gateway, plugin enhancements based on Spring Cloud Gateway have been introduced, and WebSocket has been added to a multi-capacity gateway service, mainly for forwarding user requests to specified microservices.</p><p>2) Access microservices:</p><p> UJES&#x27;s Entrance Microservice is the manager of a user&#x27;s class of assignments.From job generation to submission to execution engine, to assignment feedback to users and operations closed, access microservices managed the life cycle of an operation.</p><p>3) Engine manager:</p><p> UJES&#x27;s Engine Manager is a microservice that handles start-up engine requests, while also monitoring the life state of the engine.</p><p>4) Execution Engine:</p><p> UJES&#x27;s implementation engine is a truly microservice to perform user assignments, launched by the Engine Manager and interacts with the portals submitted to it, correctly executes operations and feeds the user needs information.</p><p>5) Application manager:</p><p> UJES&#x27;s Application Management Microservice is the maintainer of the implementation engine instance information in the cluster, and the entrance microservice always needs this information to get an available implementation engine.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-overall-architecture">2 Overall architecture<a class="hash-link" href="#2-overall-architecture" title="Direct link to heading">​</a></h2><p>The correct and secure connection of users and data and the provision of powerful and easy data job submissions to users is the goal of the UJES project.</p><p>UJES is positioned as a bridge between the upper application system and the lower computing storage engine.</p><p>Users only need to submit their large data jobs to UJES; UJES will submit them to the lower computing storage engine for execution. The logs, status, progress, results of the operation will be returned from UJES to the user in real time.</p><p>The overall structure of UJES is shown in figure 2.1.</p><p><img loading="lazy" alt="UJES Overall Architecture" src="/assets/images/ujes_overall_architecture_diagram-f7182d03c89b154dfda22d84a64de8d4.png" width="969" height="773" class="img_ev3q"><br></p><p>As shown in the graph above, the UJES framework, which is located between the upper and lower computing application systems, is the managerial role of the user operation, encapsulates data storage, computing and other functions of the large data cluster, provides a uniform operational submission framework, and users no longer need to distinguish between types such as spark or hive, but only to UJES, can properly put clusters at their own service and save for significant learning costs for users.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-logical-architecture">3 Logical architecture<a class="hash-link" href="#3-logical-architecture" title="Direct link to heading">​</a></h2><p>The UJES&#x27;s logical framework is designed based on the prevailing microservice architecture model.</p><p>The micro-service framework promotes the division of back-office services into a small group of services, which are coordinated and mutually reinforcing.</p><p>Minor scale communication mechanisms are used between micro-services and micro-services (usually HTTP-based Retful API).</p><p>This architecture model has the advantages of logic, simple deployment, extension, technical isomers, and high reliability.</p><p>The logical structure of UJES is shown in figure 3.1.</p><p><img loading="lazy" alt="UJES Logical Architecture" src="/assets/images/ujes_logical_architecture_diagram-82b7b1edbadeb689c1304385f821fa03.png" width="1172" height="622" class="img_ev3q"><br></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-ujes-operational-main-process">3.1 UJES Operational Main Process<a class="hash-link" href="#31-ujes-operational-main-process" title="Direct link to heading">​</a></h3><p>A full example of the main process of describing the operation of the UJES project and the functionality of the diagram microservice component will be described in more detail after the main process.</p><ul><li><p><strong>1. user submission assignment, gateway forwarding</strong></p><p>User A submits its own major data assignment to UJES&#x27;s gateway microservice, such as through Restful or Websocket, which will forward users&#x27; requests to the specified entrance microservice in accordance with the specified type of operation, if the user submits a spark-sql code, the gateway will submit the assignment to Spark&#x27;s entrance microservice.</p><p>Since the access microservice can be deployed in multiple cases, the gateway is transferred to suitable microservices examples in accordance with the strategy of carrying equilibrium.</p></li><li><p><strong>2.Entry procedure for parsing, checking</strong></p><p>Once the user&#x27;s job is forwarded to Spark&#x27;s entrance microservice, the parser in the entrance resolves the user&#x27;s submitted job into a running task and the persistent task is perpetuated into the database.</p><p>Pre-set interceptors also perform custom variable replacements, malicious code checks, etc. of scripts.</p><p>If a user&#x27;s request is blocked, his code will not be submitted to the cluster for execution.</p></li><li><p><strong>Setup for listener</strong></p><p>Information generated by the operation of the task will need to be processed once it is produced, such as display to the user or perpetuation to the database, which generally requires the use of event aggregates and listeners, and therefore various types of listeners for the task.</p></li><li><p><strong>4.Task Access Scheduler</strong></p><p>Once the task is generated, it will enter the scheduler pending schedule.</p><p>The core concept in the Scheduler is the consumer queue, which is identified by the consumer group, which is usually identified by both the user&#x27;s system and the user, and the consumer group can be marked Test_Anna, if the user submits a task to UJES in the system Test.</p><p>Once the task enters the scheduler it is placed in a different consumer queue waiting for the schedule, based on the group identifier.</p><p>Consumer queue threads are generally implemented in a single thread.</p></li><li><p><strong>Application management micro-service work - providing implementation engine</strong></p><p>Once the task is deployed, the entrance microservice will require an application for implementation through the engine application to the application management microservice.</p><p>The application management microservice will see whether there are engines that users can use in the cluster based on the user&#x27;s consumer group information. If there is an implementation engine that can be used by the consumer group, the information from the engine will be returned to the entrance microservice and the entrance microservice will refer the task to the executive engine for implementation.</p><p>If the application management microservice finds that there is no engine that the group can use in the cluster, a new implementation engine will be requested from the Engine Manager microservices.</p><p>The consumption thread of the entrance microservice will wait until the app manages the microservice return engine for information that is successful, failed, or timed out.</p></li><li><p><strong>6. Engine Manager Microservice - Start and Manage Engine</strong></p><p>Engine manager microservice is a microservice that initiates and manages the execution engine.</p><p>When the engine manager receives a request to launch a new engine for the application management microservice, the request will carry user&#x27;s consumer group information. The engine manager will apply for resources from the resource manager based on the consumer group information. If the user still has sufficient resources, the resource manager will allow the engine manager to start a new engine for the user and broadcast to the application management service microservice.</p></li><li><p><strong>7. Access microservice submission task to execution engine</strong></p><p>After step 7, the application management microservice has acquired information on the newly launched engine, and the application management microservice returns information from the engine to the entrance microservice, which then submits tasks to the change engine.</p></li><li><p><strong>8. Entrance interaction with engine</strong></p><p>Once the task is submitted to the implementation engine, the task is run with logs, progress and results information, which is returned to the entrance micro service through the RPC. The return information is carried with the unique identification information of the mission, which is correctly processed by the entrance microservice.</p></li><li><p><strong>Completion of the task</strong></p><p>Once the task is run on the execution engine, the successful or failed state information is returned to the entrance microservice. After the task status in the entrance microservice, the consumer queue will continue to consume tasks in the queue.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-details-of-the-architecture-and-optimization">3.2 Details of the architecture and optimization<a class="hash-link" href="#32-details-of-the-architecture-and-optimization" title="Direct link to heading">​</a></h3><p>In addition to the main processes described in sub-section 3.1, UJES has its own processes for cluster management and performance enhancement.</p><ul><li><p><strong>Task classification and diverse consumption patterns</strong></p><p>Mandates can be categorized according to their own characteristics: completely new missions, retrial missions, duplication of tasks, etc.</p><p>A new task is a new task submitted by the user, a retry task is a task that requires a retry to run a failure in certain circumstances, and a duplication of tasks is a task that is consistent with previous submissions.</p><p>After the task enters the scheduler consumer queue, if it is a new task, it will enter the Consumer&#x27;s (Consumer) of FIFO for consumption and, in case of duplication, will enter ReUse&#x27;s consumer for consumption, which will do much more than FIFO and return the results of the previous task to the user.</p></li><li><p><strong>Control of co-generation of engines</strong></p><p>In UJES, an engine that a user can start is controlled, e.g. a user can start up up to three Spark engines.The control of concomitant traffic is ensured by the combination of microservices and microservices for resource managers.</p><p>At most three active tasks per user in the access microservice will be used, so that only three engines will be used.The resource management microservice also provides assurances that if a user is to launch a fourth engine, the engine manager needs to request resources from the resource management microservice, the resource management microservice will refuse to provide resources to that user on the grounds that the number of engines exceeds the limit and the fourth engine will fail.</p></li><li><p><strong>3. Execute engine heart and unhealthy engines</strong></p><p>The application management microservice needs to perform a core leapfrogging with engines after they get information on the engine to ensure that the engine process is still alive.</p><p>If the engine does not jump back for a period of time, it will be added to the unhealthy engine, so they will not be used when requesting the engine.</p></li><li><p><strong>4. Natural demise of engines and active killing by users</strong></p><p>The presence of engines will take up cluster resources, particularly the Spark engine, which will take more queue resources, so if the engine manager detects that an execution engine is not used for a long time, then it will be necessary to kill the engine, free the resources of the cluster, and then broadcast to the application manager after the correct killing of the engine.</p><p>Users will also be willing to be active when using UJES. Users will submit a request to the gateway, the gateway will be forwarded to the engine manager, and the engine manager will kill the engine.</p></li><li><p><strong>Tenant segregation</strong></p><p>Multi-Tenant segregation is an important function of the Big Data Functional Platform, and UJES is structurally supportive of multi-tenant segregation, in conjunction with the Hadoop Ecoosphere component.</p><p>User assignments are performed on the execution engine, and UJES&#x27;s Resource Management Microservice switches to the user to execute system commands when launching a new execution engine, so that the execution engine process is the user&#x27;s permission, which is completely isolated from engines initiated by other users, thus realizing the multi-tenant separation function.</p></li><li><p><strong>Smart diagnosis</strong></p><p>Smart Diagnostics is a UJES-fine-tuned module where large data operations are often performed with a large amount of data for calculations, as well as a large amount of resources in the cluster and a longer time for an operation.</p><p>Users always want to receive feedback from clusters, such as whether data are tilted and whether queue resources are sufficient.</p><p>Smart diagnostics are designed for this need, and diagnostic modules can analyze the resources and data of the user&#x27;s job when the job is running, and transmit the content of the analysis to the user in real time.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-interface-design">4 Interface Design<a class="hash-link" href="#4-interface-design" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-external-interface-design">4.1 External Interface Design<a class="hash-link" href="#41-external-interface-design" title="Direct link to heading">​</a></h3><p>UJES External Interface means interfaces with users and clusters.</p><ul><li><p><strong>1 User Interface</strong></p><p>UJES’s user access to UJES is usually in Retful and WebSocket.</p><p>Users are required to encapsulate their requests into Json in the prescribed format, and then submit their requests through the post system.</p><p>It is recommended that users access UJES using a web-based approach.The regulation of data exchange will be given after the text.</p></li><li><p><strong>2 Cluster interface</strong></p><p>UJES&#x27;s interaction with clusters is determined by engine type.</p><p>As shown in figure 2.1, UJES&#x27;s implementation engine cuts across the UJES and cluster levels.</p><p>As an example, the Spark execution engine interacts with clusters through the Driver API provided by Spark.</p><p>When using the UJES framework, users can interface with clusters or other server resources according to their needs and characteristics.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-framework-interface-design">4.2 Framework interface design<a class="hash-link" href="#42-framework-interface-design" title="Direct link to heading">​</a></h3><p>UJES serves as a framework in which framework developers can access development according to their needs.</p><p>Access to the framework is generally based on SDK, and the UJES framework needs to be implemented for the following interfaces after users have introduced the SDK to UJES via dependency management such as Maven or gradle.</p><p>1) Access interface to entrance microservices</p><p>2) Engine Manager Access Interface</p><p>3) Engine Access Interface</p><p>Allows you to view the UJES&#x27;s access document.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-internal-functional-module-interface-design">4.3 Internal Functional Module Interface Design<a class="hash-link" href="#43-internal-functional-module-interface-design" title="Direct link to heading">​</a></h3><p>Interactions between UJES internal functionality modules are based on the Fign-based RPC method. Linkis RPC schema please<a href="/docs/0.11.0/architecture/commons/rpc">click here</a></p><p>UJES&#x27;s Entrance, EngineManager and Engineering all communicate via Linkis PRC.</p><p>In particular, the interaction between Entrance and Engineering.Entrance sends user requests via Sender to Engine&#x27;s Receiver, Engine Receiver, saves the Sender, the sender of the sending terminal, and submits the executing user&#x27;s request to send the message back to Entrance once the log/progress/state is in place.</p><p><img loading="lazy" alt="RPC Framework" src="/assets/images/rpc_framework-30c495aad4c29e773aee743e92223228.png" width="930" height="540" class="img_ev3q"><br></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-deployment-structure">5 Deployment structure<a class="hash-link" href="#5-deployment-structure" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="51-traditional-modes-of-deployment">5.1 Traditional modes of deployment<a class="hash-link" href="#51-traditional-modes-of-deployment" title="Direct link to heading">​</a></h3><p>Please view the<a href="/docs/0.11.0/deployment/quick-deploy">rapid deployment document</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/linkis-website/edit/dev/versioned_docs/version-0.11.0/architecture/ujes/ujes-design.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/0.11.0/architecture/storage/resultset-file"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ResultSet File Storage</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/0.11.0/architecture/ujes/file-import-and-export-structure"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Spark Engine File Import Export</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-document-overview" class="table-of-contents__link toc-highlight">1 Document Overview</a><ul><li><a href="#11-project-background" class="table-of-contents__link toc-highlight">1.1 Project background</a></li><li><a href="#12-interpretation-of-terms" class="table-of-contents__link toc-highlight">1.2 Interpretation of terms</a></li></ul></li><li><a href="#2-overall-architecture" class="table-of-contents__link toc-highlight">2 Overall architecture</a></li><li><a href="#3-logical-architecture" class="table-of-contents__link toc-highlight">3 Logical architecture</a><ul><li><a href="#31-ujes-operational-main-process" class="table-of-contents__link toc-highlight">3.1 UJES Operational Main Process</a></li><li><a href="#32-details-of-the-architecture-and-optimization" class="table-of-contents__link toc-highlight">3.2 Details of the architecture and optimization</a></li></ul></li><li><a href="#4-interface-design" class="table-of-contents__link toc-highlight">4 Interface Design</a><ul><li><a href="#41-external-interface-design" class="table-of-contents__link toc-highlight">4.1 External Interface Design</a></li><li><a href="#42-framework-interface-design" class="table-of-contents__link toc-highlight">4.2 Framework interface design</a></li><li><a href="#43-internal-functional-module-interface-design" class="table-of-contents__link toc-highlight">4.3 Internal Functional Module Interface Design</a></li></ul></li><li><a href="#5-deployment-structure" class="table-of-contents__link toc-highlight">5 Deployment structure</a><ul><li><a href="#51-traditional-modes-of-deployment" class="table-of-contents__link toc-highlight">5.1 Traditional modes of deployment</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Linkis</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/latest/about/introduction">Document</a></li><li class="footer__item"><a class="footer__link-item" href="/faq/main">FAQ</a></li><li class="footer__item"><a href="https://github.com/apache/linkis/releases" target="_blank" rel="noopener noreferrer" class="footer__link-item">Releases</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/apache/linkis" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://github.com/apache/linkis/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Issue Tracker</a></li><li class="footer__item"><a href="https://github.com/apache/linkis/pulls" target="_blank" rel="noopener noreferrer" class="footer__link-item">Pull Requests</a></li></ul></div><div class="col footer__col"><div class="footer__title">Subscribe Mailing List</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/community/how-to-subscribe">How to Subscribe</a></li><li class="footer__item"><a href="mailto:dev-subscribe@linkis.apache.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Subscribe Mail</a></li><li class="footer__item"><a href="https://lists.apache.org/list.html?dev@linkis.apache.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mail Archive</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><div><img style="height:50px" alt="Apache Software Foundation" src="/img/incubator-logo.svg"><p style="color: #999999;  padding: 0 20px 30px;font-weight:400;text-align:left">Apache Linkis is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.</p><p></p>
             <p style="padding: 0 20px 30px;color: #999999;font-weight: 400;"> Copyright © 2023 The Apache Software Foundation. Licensed under the Apache License, Version 2.0. Apache Linkis, Apache Incubator, Apache, the Apache feather logo, the Apache Linkis logo and the Apache Incubator project logo are trademarks of The Apache Software Foundation.</p>
             <div></div></div></div></div></div></footer></div>
<script src="/assets/js/runtime~main.64b43126.js"></script>
<script src="/assets/js/main.b45cbd22.js"></script>
</body>
</html>